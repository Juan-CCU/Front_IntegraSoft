{% extends 'templates_generales/template_main.html' %}
{% load static %}
{% block content %}

{% block script_limpiar %} <script src="{% static 'js/limpiar.js' %}"></script>{% endblock script_limpiar %}
{% block script_cargar %} <script src="{% static 'js/listener.js' %}"></script>{% endblock script_cargar %}

<div class="container">
  <h1 class="text-center mt-4">Formulario de Búsqueda</h1>
  <form action="buscar_usuarios" method="GET" class="mt-4">
    <div class="row">
      <div class="col-md-3">
        <label for="person_number">Número de Persona:</label>
        <input type="text" id="Person_Number" name="Person_Number" class="form-control" value="{{ formulario_data.Person_Number }}">
      </div>
      <div class="col-md-3">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" class="form-control" value="{{ formulario_data.nombre }}"> 
      </div>
      <div class="col-md-3">
        <label for="BusinessUnitName">Unidad de Negocio:</label>
        <input type="text" id="BusinessUnitName" name="BusinessUnitName" class="form-control" value="{{ formulario_data.BusinessUnitName }}">
      </div>
      <div class="col-md-3">
        <label for="LegislationCode">Código de Legislación:</label>
        <input type="text" id="LegislationCode" name="LegislationCode" class="form-control" value="{{ formulario_data.LegislationCode }}">
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-md-4">
        <label for="base_datos">Consultar sistema: </label>
        <select class="form-control form-control-sm" id="base_datos" name="base_datos">
            <option value="PeopleSoft">PeopleSoft</option>
            <option value="HCM">HCM</option>
        </select>
    </div>
        {% if error_message %}
        <style>
            {% if 'Person_Number' in campos_vacios %} #Person_Number { border-color: red; } {% endif %}
            {% if 'nombre' in campos_vacios %} #nombre { border-color: red; } {% endif %}
            {% if 'BusinessUnitName' in campos_vacios %} #BusinessUnitName { border-color: red; } {% endif %}
            {% if 'LegislationCode' in campos_vacios %} #LegislationCode { border-color: red; } {% endif %}
        </style>
      {% endif %}
  

    <script>
        const select = document.getElementById("base_datos");     
        const selectedValue = localStorage.getItem("selectedValue");
        if (selectedValue) {
            select.value = selectedValue;
        }
        
        select.addEventListener("change", function () {
            localStorage.setItem("selectedValue", this.value);
        });
    </script>
{% block css %} <link rel="stylesheet" type="text/css" href="{% static 'css/botones.css' %}">{% endblock css %}
    <div class="d-flex align-items-center mt-3">
      <button id= "buscar" type="submit" class="btn btn-primary">Buscar</button>
      <a id= "limpiar" href="buscar_usuarios" class="btn btn-danger" onclick="limpiarFormulario()">Limpiar</a> <!-- Enlace para limpiar la búsqueda -->
    </div>
    </div>
  </form>
</div>
{% if error_message %}
<div class="alert alert-danger mt-3">
  {{ error_message }}
</div>
<div class="pagination">
  <span class="step-links">
      {% if registros_pagina.has_previous %}
          <a href="?page=1&Person_Number={{ formulario_data.Person_Number }}&nombre={{ formulario_data.nombre }}&BusinessUnitName={{ formulario_data.BusinessUnitName }}&LegislationCode={{ formulario_data.LegislationCode }}&base_datos={{ formulario_data.base_datos }}">primero</a>
          <a href="?page={{ registros_pagina.previous_page_number }}&Person_Number={{ formulario_data.Person_Number }}&nombre={{ formulario_data.nombre }}&BusinessUnitName={{ formulario_data.BusinessUnitName }}&LegislationCode={{ formulario_data.LegislationCode }}&base_datos={{ formulario_data.base_datos }}">anterior</a>
      {% endif %}

      <span class="current">
          Página {{ registros_pagina.number }} de {{ registros_pagina.paginator.num_pages }}.
      </span>

      {% if registros_pagina.has_next %}
         <a href="?page={{ registros_pagina.next_page_number }}&Person_Number={{ formulario_data.Person_Number }}&nombre={{ formulario_data.nombre }}&BusinessUnitName={{ formulario_data.BusinessUnitName }}&LegislationCode={{ formulario_data.LegislationCode }}&base_datos={{ formulario_data.base_datos }}">siguiente</a>
         <a href="?page={{ registros_pagina.paginator.num_pages }}&Person_Number={{ formulario_data.Person_Number }}&nombre={{ formulario_data.nombre }}&BusinessUnitName={{ formulario_data.BusinessUnitName }}&LegislationCode={{ formulario_data.LegislationCode }}&base_datos={{ formulario_data.base_datos }}">último</a>
      {% endif %}
  </span>
</div>

{% endif %}
{% block grilla_usuarios %}
{% endblock grilla_usuarios %}
{% endblock content %}
